# ==============================================================================
# NETWORKING ROLE DEFAULT VARIABLES
# ==============================================================================
#
# Default configuration variables for the Ansible networking role.
#
# These variables can be overridden, with group, host or playbook specific variables
# using the same name:
#   - group_vars/
#   - host_vars/
#   - playbook vars
#
# NOTE: Ansible will override everything under the root boilerplate_ variable. 
# Meaning you need to include all variables when overriding, else the other variables 
# will not be found.
#
# Copy the below defaults into your host_var file and overwrite with host specific
# variables
# ------------------------------------------------------------------------------

---

# ---------------------------- [ NETWORKING ] ----------------------------------

## Arti (Tor Client)
# https://gitlab.torproject.org/tpo/core/arti
networking_arti:
  user: 'arti'
  group: 'arti'
  release_tag: 'arti-v1.4.5'                        # <-- https://gitlab.torproject.org/tpo/core/arti/-/tags
  listen_address: '127.0.0.1'                       # Networking interface binding address
  socks_port: 9055                                  # TOR SOCKS proxy port
  metrics_port: 9179                                # Prometheus metrics port
  dns_port: 0                                       # 0 means disabled, when DNS is typically handled through SOCKS proxy
  log_level: 'warn'                                 # Set to info, debug, warn, error, or trace
  predicted_ports: [80, 443]

# DuckDNS Configuration
networking_ddns:
  user: 'duckdns'
  group: 'duckdns'
  domain: '{{ vault_networking_ddns_domain }}'
  token: '{{ vault_networking_ddns_token }}'

networking_homepage:
  user: 'homepage'
  group: 'homepage'
  release: 'v1.4.0' # <-- https://github.com/gethomepage/homepage/releases
  port: '3000'
  hostname: '{{ ansible_hostname }}'
  title: '{{ ansible_hostname }} - Homepage'
  description: 'A server for doing xyz'
  theme: 'dracula' # Options: light, dark, dracula, etc.
  allowed_hosts: '{{ ansible_hostname }}, {{ ansible_hostname }}:3000, {{ ansible_fqdn }}, {{ ansible_fqdn }}:3000' # <-- When pasting into host_vars, update to include vault_hostname_address
  data_dir: '/var/www'

# I2P Daemon Configuration
# https://i2pd.readthedocs.io/en/latest/configuration.html
networking_i2pd:
  user: 'i2pd'
  group: 'i2pd'
  release: '2.57.0' # <-- https://github.com/PurpleI2P/i2pd/releases
  log_level: 'info'  # Options: none, error, warn, info, debug, trace
  console:
    port: 7070
    listen_address: '127.0.0.1'
  sam:
    listen_address: '127.0.0.1'
    port_tcp: 7656
    port_udp: 7655
  path_prefix: 'i2p'

# Let's Encrypt TLS Certificate
networking_lets_encrypt:
  user: 'letsencrypt'                                                 # User for Let's Encrypt tasks
  group: 'letsencrypt'                                                # Group for Let's Encrypt tasks
  domain: '{{ ansible_fqdn }}'                                        # Domain for the certificate
  domain_email: '{{ vault_networking_domain_email }}'                 # Email for Let's Encrypt notifications
  cloudflare_dns_api_key: '{{ vault_networking_cloudflare_token }}'   # Cloudflare DNS API key
  private_key_path: '/etc/letsencrypt/live/{{ ansible_fqdn }}/privkey.pem'
  certificate_path: "/etc/letsencrypt/live/{{ ansible_fqdn }}/fullchain.pem"

# Network configuration
networking_networks: 
  local: "{{ vault_networks_local }}"
  lan_gateway_ip: '{{ vault_networks_lan_gateway_ip }}'
  unifi_vpn_client_subnet: '{{ vault_networks_unifi_vpn_client_subnet }}'

## Nginx Configuration
networking_nginx:
  user: 'root'
  group: 'root'
  hostname: "{{ ansible_hostname }}"                   # Hostname for Nginx server
  sites_available_dir: "/etc/nginx/sites-available"    # Directory for Nginx site configurations
  sites_enabled_dir: "/etc/nginx/sites-enabled"        # Directory for enabled Nginx sites
  sites_location_dir: "/etc/nginx/conf.d"              # Directory for Nginx location blocks

## OpenVPN Client Configuration
networking_openvpn_client:
  user: 'root'
  group: 'root'
  config_download: "{{ vault_vpn_config_download }}"   # URL to download OpenVPN config zip
  vpn_server: '{{ vault_vpn_server }}'
  dns_servers: "209.222.18.218 209.222.18.222 1.1.1.1 9.9.9.9"           # List of DNS servers to use when VPN is active

networking_samba:
  user: 'samba'
  group: 'samba'
  workgroup: '{{ vault_networking_domain }}'           # Samba workgroup name
  interfaces: 'lo eth0 wlan0'                          # Network interfaces for Samba
  smb_config_path: '/etc/samba/smb.conf'               # Path to Samba configuration file
  shares:
    - name: 'shared'
      path: '/srv/samba/shared'
      read_only: no
      valid_users:
        - 'user1'
        - 'user2'
  users: "{{ vault_networking_samba_users }}"         # List of users with passwords

## SSH Configuration
networking_ssh:
  user: 'root'
  group: 'root'
  listen_address: "0.0.0.0"                             # SSH listenging address
  listen_port: "22"                                     # SSH listenging port
  user_access_group: 'ssh-users'                        # Group for SSH access
  user_access_list: "{{ vault_ssh_user_access_list }}"  # List of users with SSH access

## UFW Configuration
networking_ufw:
  user: 'root'
  group: 'root'

## WireGuard VPN Configuration
networking_wireguard_vpn:
  interface_name: 'privadovpn'
  private_key: "{{ vault_wireguard_private_key }}"
  public_key: "{{ vault_wireguard_public_key }}"
  address: "{{ vault_wireguard_address }}"
  dns: "{{ vault_wireguard_dns }}"
  endpoint: "{{ vault_wireguard_endpoint }}"
  allowed_ips: "{{ vault_wireguard_allowed_ips }}"
  auto_start: true

## VPN Kill Switch Configuration
networking_vpn_kill_switch:
  enabled: true
  vpn_service: "wg-quick@privadovpn"
  vpn_interface: "{{ networking_wireguard_vpn.interface_name }}"
  allow_local_networks: true
  allow_dhcp: true
  log_dropped_packets: false
  test_enabled: false