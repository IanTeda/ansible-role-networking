# ------------------------------------------------------------------------------
# Valkey Role Handlers
# ------------------------------------------------------------------------------
#
# Handlers are special tasks that only run when triggered by other tasks.
# They are typically used for service restarts, reloads, or other actions
# that should only happen when configuration changes occur.
#
# Triggering handlers:
#   - Tasks use 'notify: handler_name' to trigger handlers
#   - Handlers only run if the notifying task reports 'changed' status
#   - All handlers run at the end of the play (after all tasks complete)
#   - Handlers run in the order they are defined, not notification order
#   - Each handler runs only once per play, even if notified multiple times
#
# Task usage example:
#   - name: Update SSHD config
#     template:
#       src: templates/sshd.conf.j2
#       dest: /etc/sshd/sshd.conf
#     notify: SSHD Restart
#
# ------------------------------------------------------------------------------

---

- name: Nginx Restart
  ansible.builtin.systemd:
    name: nginx
    state: restarted
    enabled: true
    daemon_reload: true
  become: true

- name: OpenVPN Restart
  ansible.builtin.systemd:
    name: openvpn@client
    state: restarted
    enabled: true
    daemon_reload: true
  become: true

- name: SSH Restart
  ansible.builtin.systemd:
    name: ssh
    state: restarted
    enabled: true
    daemon_reload: true
  become: true

- name: Samba Restart
  ansible.builtin.systemd:
    name: samba
    state: restarted
    enabled: true
    daemon_reload: true
  become: true

- name: UFW Restart
  ansible.builtin.systemd:
    name: ufw
    state: restarted
    enabled: true
    daemon_reload: true
  become: true

- name: Alloy Restart
  ansible.builtin.systemd:
    name: alloy
    state: restarted
    enabled: true
    daemon_reload: true
  become: true

- name: WireGuard Restart
  ansible.builtin.systemd:
    name: "wg-quick@{{ networking_wireguard_privadovpn.interface_name }}"
    state: restarted
    enabled: true
    daemon_reload: true
  become: true

- name: Reload UFW
  community.general.ufw:
    state: reloaded
  become: true